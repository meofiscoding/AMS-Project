@{
       ViewData["Title"] = "Register";
}
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-center">Login Form</h3>
                    </div>
                    <div class="card-body">
                        <form id="login-form">
                            <div class="form-group">
                                <label for="email">Email address</label>
                                <input type="email" class="form-control" name="email" placeholder="Enter email">
                            </div>
                        <div class="form-group">
                            <label>Role</label><br>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="role" id="teacher" value="4">
                                <label class="form-check-label" for="teacher">Teacher</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="role" id="student" value="3" checked>
                                <label class="form-check-label" for="student">Student</label>
                            </div>
                        </div>
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input type="password" class="form-control" name="password" placeholder="Password">
                            </div>
                            <button type="submit" class="btn btn-primary btn-block">Login</button>
                        </form>
                        @* link to register page *@
                        <div class="text-center">
                            <a asp-action="Index" asp-controller="Register">Register</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script type="text/javascript">
     $(document).ready(function() {
    debugger;
    //check if token is it localStorage
    if(localStorage.getItem("token") != null) {
         window.location.href = "/Home";
    }
        //on login form submit
        $("#login-form").submit(function (e) {
            e.preventDefault();
            //call api to login
            $.ajax({
                 url: "https://localhost:7290/api/Auth/login",
                 type: "POST",
                 contentType: "application/json",
                    data: JSON.stringify({
                        UserEmail : $('input[name=email]').val(),
                        UserPassword : $('input[name=password]').val(),
                        UserRoleId : $('input[name=role]:checked').val()
                    }),
                    success: function(response) {
                        //save token in local storage
                        localStorage.setItem("token", response.token);
          // redirect to login page
            window.location.href = "/Home";
        },
        error: function(xhr, status, error) {
            // Display the error message
            alert(xhr.responseJSON.message);
        }
                    })
        });
     });
    </script>
}